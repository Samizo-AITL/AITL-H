# 📘 PID使用ノート – 制御パラメータ設計と応答性の調整

このドキュメントでは、AITL-Hにおける物理層制御（PID）の設計・運用に関する実践的知見を整理します。  
PID制御はシンプルながらも、パラメータ設計や制御対象に応じたチューニングが必要です。

---

## ⚙️ 1. PID各項の意味と設計指針

| 項目 | 内容 | 調整の目的 |
|------|------|------------|
| Kp（比例） | 偏差の大きさに比例した出力 | 応答性向上、遅れの短縮 |
| Ki（積分） | 偏差の累積に対する出力 | 定常誤差の除去 |
| Kd（微分） | 偏差の変化速度に対する出力 | オーバーシュートの抑制、先読み制御 |

---

## 🔍 2. 代表的なチューニング法

### 🔸 Ziegler-Nichols法（ステップ応答ベース）

1. Ki, Kd = 0 にして Kp を徐々に上げる  
2. 出力が安定に発振する直前の Kp を `Ku`、その周期を `Tu` とする  
3. 以下の表に従って各パラメータを設定：

| モード | Kp | Ki | Kd |
|--------|----|----|----|
| P      | 0.5Ku | 0 | 0 |
| PI     | 0.45Ku | 1.2Kp/Tu | 0 |
| PID    | 0.6Ku | 2Kp/Tu | KpTu/8 |

---

### 🔸 手動調整

1. Kp を少しずつ上げて応答性を確認  
2. Ki を上げて定常誤差を除去  
3. Kd を加えてオーバーシュートや振動を抑制

---

## 🧪 3. 応答性の評価指標

- **上昇時間（Rise Time）**：目標値に到達するまでの時間
- **オーバーシュート**：目標値を超える最大値
- **定常誤差**：最終的な偏差の残り
- **応答の滑らかさ**：微分ノイズの影響確認

---

## 🚧 4. 注意点と実装上の工夫

- 積分飽和を避けるための**アンチワインドアップ処理**が重要
- センサノイズにより微分項が不安定化する場合は**ローパスフィルタ**を併用
- PID制御対象の**時間遅れ**（Dead Time）を考慮した設計が必要
- MIMO系（多関節制御など）では**各軸の分離性**を意識した制御設計を行う

---

## 🧠 AITL-Hでの連携設計観点

- LLMからの意図（例：「歩く」「止まる」）を FSMで解釈し、最終的に PIDが**数値出力として実現**
- 状態に応じて PIDゲインを**動的に切り替える設計**（例：立ち上がり中は応答重視、姿勢保持中は安定性重視）
- 将来的に LLMによる**パラメータチューニング支援**も検討可能

---

## ✍️ 制作者より

PID制御は一見単純に見えますが、**システムの安定性と品質を保証するための要**です。  
PoC段階では観察・記録・シミュレーションを重ねながら、自律的に応答性を最適化できる設計を目指してください。
