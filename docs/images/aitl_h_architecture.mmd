flowchart TB
  subgraph LLM["LLM Layer"]
    L1[Decision-Making]
    L2[Anomaly Detection]
    L3[Language Response]
  end

  subgraph PID["PID Layer"]
    P1[Continuous Control]
    P2[Joint Angles / MIMO]
  end

  subgraph FSM["FSM Layer"]
    F1[Logic Control]
    F2[State Transitions]
  end

  LLM -->|Scenario / Commands| FSM
  FSM -->|Mode Control / Gain Select| PID
  PID -->|PWM / Control Signals| ACT[Actuators]
  ACT -->|Motion Response| SEN[Sensors (IMU, etc.)]
  SEN -.->|Perception Feedback| LLM

  classDef box fill:#eaf5ff,stroke:#6ca7ff,stroke-width:1px,rx:6,ry:6;
  class LLM,PID,FSM box
  class ACT,SEN box
