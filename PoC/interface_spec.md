---
layout: default
title: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ä»•æ§˜ï¼ˆAITL-H PoCï¼‰
nav_order: 2
description: FSMã‚’èµ·ç‚¹ã¨ã—ãŸåˆ¶å¾¡ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆPID, PWM, UART, ã‚»ãƒ³ã‚µï¼‰é–“ã®ä¿¡å·æ§‹é€ ãƒ»å…¥å‡ºåŠ›ä»•æ§˜
permalink: /AITL-H/interface_spec/
---

# ğŸ”Œ interface_spec.md â€” ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ä»•æ§˜ï¼ˆAITL-H PoCï¼‰

FSMã‚’èµ·ç‚¹ã¨ã—ãŸåˆ¶å¾¡ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆPID, PWM, UART, ã‚»ãƒ³ã‚µï¼‰é–“ã®ä¿¡å·æ§‹é€ ãƒ»å…¥å‡ºåŠ›ä»•æ§˜ã‚’å®šç¾©ã—ã¾ã™ã€‚

---

## ğŸ“‚ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ã¨æ¦‚è¦

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å   | æ©Ÿèƒ½                             |
|----------------|----------------------------------|
| `fsm_engine`   | è¡Œå‹•åˆ¶å¾¡ï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰            |
| `pid_controller` | PIDåˆ¶å¾¡ï¼ˆé€Ÿåº¦ãƒ»è§’åº¦ï¼‰           |
| `uart_driver`  | LLMå‘½ä»¤å—ä¿¡ï¼å¿œç­”é€ä¿¡            |
| `sensor_interface` | è·é›¢ï¼è§’åº¦ã‚»ãƒ³ã‚µã®å–å¾—         |
| `pwm_driver`   | å‡ºåŠ›ç”¨PWMæ³¢å½¢åˆ¶å¾¡                |

---

## ğŸ” å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å…¥å‡ºåŠ›ä¿¡å·å®šç¾©

### 1. fsm_engine

| ä¿¡å·å        | bitå¹… | æ–¹å‘ | æ¥ç¶šå…ˆ         | èª¬æ˜                        |
|---------------|--------|------|----------------|-----------------------------|
| `uart_cmd`    | 8bit  | IN   | `uart_driver`  | LLMå‘½ä»¤æ–‡å­—åˆ—ï¼ˆASCIIï¼‰     |
| `distance`    | 16bit | IN   | `sensor_interface` | è·é›¢ã‚»ãƒ³ã‚µå€¤ï¼ˆcmå˜ä½ï¼‰     |
| `angle_error` | 16bit | IN   | `sensor_interface` | è§’åº¦èª¤å·®ï¼ˆdegå˜ä½ï¼‰        |
| `fsm_state`   | 3bit  | OUT  | å…¨ä½“           | ç¾åœ¨çŠ¶æ…‹ï¼ˆIDLE=000, WALK=001...ï¼‰ |
| `target_speed`| 16bit | OUT  | `pid_controller` | é€Ÿåº¦æŒ‡ä»¤å€¤ï¼ˆcm/sï¼‰         |
| `target_angle`| 16bit | OUT  | `pid_controller` | å›è»¢è§’æŒ‡ä»¤å€¤ï¼ˆdegï¼‰        |
| `pwm_enable`  | 1bit  | OUT  | `pwm_driver`   | PWMå‹•ä½œON/OFFåˆ¶å¾¡          |
| `uart_resp`   | 8bit  | OUT  | `uart_driver`  | çŠ¶æ…‹å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ–‡å­—     |

---

### 2. pid_controller

| ä¿¡å·å        | bitå¹… | æ–¹å‘ | æ¥ç¶šå…ˆ         | èª¬æ˜                        |
|---------------|--------|------|----------------|-----------------------------|
| `target_speed`| 16bit | IN   | `fsm_engine`   | å‰é€²é€Ÿåº¦æŒ‡ä»¤                |
| `target_angle`| 16bit | IN   | `fsm_engine`   | å›è»¢è§’åº¦æŒ‡ä»¤                |
| `distance`    | 16bit | IN   | `sensor_interface` | å®Ÿè·é›¢                      |
| `angle`       | 16bit | IN   | `sensor_interface` | å®Ÿè§’åº¦                      |
| `control_pwm` | 8bit  | OUT  | `pwm_driver`   | PWMãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£å‡ºåŠ›           |

---

### 3. pwm_driver

| ä¿¡å·å        | bitå¹… | æ–¹å‘ | æ¥ç¶šå…ƒ           | èª¬æ˜                      |
|---------------|--------|------|------------------|---------------------------|
| `pwm_enable`  | 1bit   | IN   | `fsm_engine`     | PWMå‡ºåŠ›ã®ON/OFFä¿¡å·      |
| `control_pwm` | 8bit   | IN   | `pid_controller` | ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ï¼ˆ0ã€œ255ï¼‰   |
| `pwm_out`     | 1bit   | OUT  | å¤–éƒ¨ï¼ˆãƒ¢ãƒ¼ã‚¿ï¼‰    | å®Ÿéš›ã®PWMæ³¢å½¢å‡ºåŠ›        |

---

### 4. uart_driver

| ä¿¡å·å     | bitå¹… | æ–¹å‘ | æ¥ç¶šå…ˆ        | èª¬æ˜                              |
|------------|--------|------|---------------|-----------------------------------|
| `uart_cmd` | 8bit  | OUT  | `fsm_engine`  | å—ä¿¡ã—ãŸLLMå‘½ä»¤ï¼ˆASCIIï¼‰         |
| `uart_resp`| 8bit  | IN   | `fsm_engine`  | çŠ¶æ…‹å¿œç­”æ–‡å­—ï¼ˆ"W", "S", "T"ãªã©ï¼‰ |
| `tx`       | 1bit  | OUT  | å¤–éƒ¨UARTãƒãƒ¼ãƒˆ | UARTé€ä¿¡ãƒ©ã‚¤ãƒ³                    |
| `rx`       | 1bit  | IN   | å¤–éƒ¨UARTãƒãƒ¼ãƒˆ | UARTå—ä¿¡ãƒ©ã‚¤ãƒ³                    |

---

### 5. sensor_interface

| ä¿¡å·å        | bitå¹… | æ–¹å‘ | æ¥ç¶šå…ˆ             | èª¬æ˜                         |
|---------------|--------|------|--------------------|------------------------------|
| `distance`    | 16bit | OUT  | `fsm_engine`, `pid_controller` | è·é›¢ã‚»ãƒ³ã‚µå€¤ï¼ˆå˜ä½ï¼šcmï¼‰     |
| `angle`       | 16bit | OUT  | `pid_controller`   | ç¾åœ¨ã®è§’åº¦ï¼ˆå˜ä½ï¼šdegï¼‰       |
| `angle_error` | 16bit | OUT  | `fsm_engine`       | ç›®æ¨™è§’ã¨ã®èª¤å·®ï¼ˆdegï¼‰         |

---

## ğŸ“˜ ä¿¡å·ãƒã‚¹å‘½åè¦ç´„ï¼ˆä¾‹ï¼‰

| é …ç›® | å‘½åä¾‹         | èª¬æ˜               |
|------|----------------|--------------------|
| çŠ¶æ…‹å‡ºåŠ›ä¿¡å· | `fsm_state`     | FSMã®ç¾åœ¨çŠ¶æ…‹ã‚³ãƒ¼ãƒ‰ |
| PWMåˆ¶å¾¡ä¿¡å· | `control_pwm`  | PIDå‡ºåŠ›ã®PWMå€¤      |
| LLMå‘½ä»¤å…¥åŠ› | `uart_cmd`     | UARTçµŒç”±ã®æ–‡å­—åˆ—    |

---

## ğŸ”— é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- [`fsm_state_table.md`](./fsm_state_table.md)ï¼šçŠ¶æ…‹ã¨å‡ºåŠ›å®šç¾©
- [`pid_design_spec.md`](./pid_design_spec.md)ï¼šPIDåˆ¶å¾¡ç›®æ¨™ã¨è¨­è¨ˆä»•æ§˜ï¼ˆæ¬¡ã‚¹ãƒ†ãƒƒãƒ—ã§ä½œæˆï¼‰
- [`system_block_diagram.svg`](./system_block_diagram.svg)ï¼šæ§‹æˆå›³ï¼ˆä½œå›³äºˆå®šï¼‰
