<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>{{ page.title | default: site.title }}</title>
    {%- if site.plugins contains "jekyll-seo-tag" -%}{% seo %}{%- endif -%}
    <meta name="color-scheme" content="light" />
    <link rel="canonical" href="{{ page.url | absolute_url }}" />

    <!-- CSS（常に最新を読む：キャッシュバスター付与） -->
    <link rel="stylesheet"
          href="{{ '/assets/css/style.css' | relative_url }}?v={{ site.time | date: '%s' }}" />
    <link rel="icon" href="{{ '/assets/favicon.png' | relative_url }}" />

    <!-- （任意）MathJax を使う場合は有効化 -->
    <script>
      window.MathJax = {
        tex:{ inlineMath:[['$','$'],['\\(','\\)']], displayMath:[['$$','$$'],['\\[','\\]']] },
        options:{ skipHtmlTags:['script','style','textarea','pre','code'] }
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <!-- Mermaid（図） -->
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  </head>

  <!-- ★ ポータル統一トーン（セピア固定） -->
  <body class="theme-sepia">
    <main class="container" aria-label="Content">
      <!-- 幅・余白を安定化（必要ならCSSへ移行OK） -->
      <div class="wrapper" style="max-width:980px;margin:0;padding:1.5rem 1rem;">
        {{ content }}
      </div>
    </main>

    <!-- Mermaid 初期化：```mermaid → <div class="mermaid"> 置換 + 中央寄せ + ライト固定 -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('code.language-mermaid').forEach(function (code) {
          const pre = code.closest('pre');
          const div = document.createElement('div');
          div.className = 'mermaid';
          div.textContent = code.textContent;
          (pre || code).replaceWith(div);
        });
        if (window.mermaid) {
          mermaid.initialize({ startOnLoad: true, securityLevel: 'loose', theme: 'default' });
        }
      });
    </script>
  </body>
</html>
