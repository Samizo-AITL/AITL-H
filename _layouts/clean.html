<!DOCTYPE html>
<html lang="ja">
  <head>
    {%- include head.html -%}
    <!-- ✅ 共通スタイル（キャッシュバスター付きで常に最新を読み込み） -->
    <link rel="stylesheet"
          href="{{ '/assets/css/style.css' | relative_url }}?v={{ site.time | date: '%s' }}" />
    <meta name="color-scheme" content="light"><!-- ダーク強制回避 -->
  </head>

  <body class="theme-sepia">
    <main class="page-content" aria-label="Content">
      <div class="wrapper" style="max-width:980px;margin:0;padding:1.5rem 1rem;">
        {{ content }}
      </div>
    </main>
    {%- include footer.html -%}

    <!-- ✅ Mermaid -->
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll("code.language-mermaid").forEach(function (code) {
          const pre = code.closest("pre");
          const div = document.createElement("div");
          div.className = "mermaid";
          div.textContent = code.textContent;
          (pre || code).replaceWith(div);
        });
        if (window.mermaid) {
          mermaid.initialize({ startOnLoad: true, theme: "default", securityLevel: "loose" });
        }
      });
    </script>

    <!-- ✅ MathJax -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [["$", "$"], ["\\(", "\\)"]],
          displayMath: [["$$", "$$"], ["\\[", "\\]"]]
        },
        options: { skipHtmlTags: ["script", "noscript", "style", "textarea", "pre", "code"] }
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  </body>
</html>
