# 第6章：センサ混載技術とアナログIF設計（AITL構造反映）

## 🎯 本章の目的

PoC設計においてセンサは環境認識の基盤であり、FSMやPIDと連携して動作制御に関与します。  
本章では、センサ混載技術とそのアナログIF（インターフェース）設計、AITLとの関係性を解説します。

---

## 🔍 主要センサの分類と用途

| 種別       | 例                    | 用途例                   |
|------------|------------------------|----------------------------|
| 距離センサ | ToF, 超音波             | 接近検出、障害物回避         |
| 姿勢センサ | 加速度、ジャイロ        | 動作フィードバック、バランス制御 |
| 接触センサ | タッチ、圧力             | 物体接触検知、介護支援         |
| 生体センサ | 心拍、温度、CO₂          | 見守り、健康状態モニタ         |

---

## 🧠 AITL構造とセンサ信号の関係

| AITL層     | センサ信号との対応例                      |
|------------|--------------------------------------------|
| 本能（FSM） | しきい値検出、トリガ状態への遷移             |
| 理性（PID） | 制御量としての連続値（距離、加速度など）       |
| 知性（LLM） | 異常状態や傾向検出に基づく高度な判断           |

---

## 🔌 アナログIF構成の基本構造

センサ信号（アナログ） → AFE（増幅・フィルタ） → ADC → FSM/PIDに渡す  
AFE設計は以下を考慮：

- 入力インピーダンスの確保（高精度センサ）
- 雑音除去フィルタ（LPF/HPF）
- ゲイン調整（可変アンプ）
- 12bit以上のADCを推奨

---

## ⚙️ FSMとの組み合わせ例（接近センサ）

```text
状態：idle
  └─ センサ値 < 20cm → 状態：approach_target
状態：approach_target
  └─ センサ値 < 5cm → 状態：interact
```

	•	状態遷移はFSMに記述し、センサ値のしきい値を制御パラメータ化
	•	センサドライバからFSMへ割り込み・イベント送出方式を推奨

---

## 🧪 実装例と評価視点
	•	センサ信号のばらつき評価（温度・経年変化）
	•	ADC変換ビット数と時間分解能の検討
	•	複数センサ入力の同時性／衝突処理設計

---

 ## 📁 モジュール構成例（PoC用）
```
 sensor_if/
├── tof_driver.v
├── adc_ctrl.v
├── sensor_mux.v
├── sensor_config.yaml
└── sensor_testbench.v
```
---

## 📬 連絡先

執筆・設計：三溝 真一（Shinichi Samizo）
GitHub: https://github.com/Samizo-AITL
Email: shin3t72@gmail.com

---

